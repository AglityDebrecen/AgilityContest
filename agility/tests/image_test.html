<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  dir="ltr">
<head>
    <title>Ajax send image data test</title>
    <meta name="description" content="" />
    <!--
    from: http://sunbox.github.io/image-to-canvas-to-image/ 
     -->
    <script type="text/javascript" src="../lib/jquery-easyui-1.4.1/jquery.min.js"></script>
    <script type="text/javascript">
        var sendImage= function() {
            // Get the image
            var img = document.getElementById("imagen");
            var canvas = document.createElement("canvas");
            canvas.width = img.width;
            canvas.height = img.height;
            canvas.getContext("2d").drawImage(img, 0, 0);
            $.ajax({
          		type: 'POST',
            	url: '/agility/server/database/clubFunctions.php',
            	dataType: 'text',
            	data: {
            		Operation: 'testlogo',
            		imagedata: canvas.toDataURL("image/png")
            	},
            	contentType: 'application/x-www-form-urlencoded;charset=UTF-8',
            	success: function(data) { $('#newimage').attr('src',data); },
            	error: function() { alert("error");	}
           	});
		}
    </script>
</head>
<body>
	<div id="content-left">
		<h1 style="margin-top:20px;">send &amp; receive an image with ajax</h1>	
		<p><img src="gaviota.jpg" id="imagen" /></p>
		<p><input id="send" type="submit" onclick="sendImage()" /></p>
		<p><img src="" id="newimage" alt="nueva imagen"></img></p>
	</div>
</body>
</html>